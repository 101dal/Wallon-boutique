<button class="voir-images" data-product-id="789" data-images-ids='["img1","img2","img3"]'>
    Afficher les images
</button>

<script>
    document.querySelector('.voir-images').addEventListener('click', async function () {
        const productId = this.dataset.productId;
        console.log(this.dataset.imagesIds)
        const imagesIds = JSON.parse(this.dataset.imagesIds);

        // Cr√©ation du conteneur principal
        const imageList = document.createElement('div');
        imageList.style.display = 'flex';
        imageList.style.justifyContent = 'space-evenly';
        imageList.style.flexWrap = 'wrap';
        imageList.style.gap = '15px';
        imageList.style.padding = '20px 0';

        // Ajout des images existantes
        imagesIds.forEach(imgId => {
            const imageWrapper = document.createElement('div');
            imageWrapper.style.position = 'relative';
            imageWrapper.style.width = '120px';
            imageWrapper.style.height = '120px';
            imageWrapper.style.borderRadius = '8px';
            imageWrapper.style.overflow = 'hidden';
            imageWrapper.style.cursor = 'pointer';
            imageWrapper.style.transition = 'transform 0.2s';

            // Image principale
            const img = document.createElement('img');
            img.style.width = '100%';
            img.style.height = '100%';
            img.style.objectFit = 'cover';
            img.src = `https://picsum.photos/seed/${imgId}/200/200`;

            // Overlay de suppression
            const deleteOverlay = document.createElement('div');
            deleteOverlay.style.position = 'absolute';
            deleteOverlay.style.top = '0';
            deleteOverlay.style.left = '0';
            deleteOverlay.style.width = '100%';
            deleteOverlay.style.height = '100%';
            deleteOverlay.style.backgroundColor = 'rgba(220, 53, 69, 0.7)';
            deleteOverlay.style.display = 'flex';
            deleteOverlay.style.alignItems = 'center';
            deleteOverlay.style.justifyContent = 'center';
            deleteOverlay.style.opacity = '0';
            deleteOverlay.style.transition = 'opacity 0.25s ease';

            // Ic√¥ne corbeille
            const trashIcon = document.createElement('div');
            trashIcon.innerHTML = 'üóë';
            trashIcon.style.color = 'white';
            trashIcon.style.fontSize = '28px';
            trashIcon.style.filter = 'drop-shadow(0 2px 4px rgba(0,0,0,0.3))';

            // Gestion des √©v√©nements
            imageWrapper.addEventListener('mouseenter', () => {
                deleteOverlay.style.opacity = '1';
                imageWrapper.style.transform = 'scale(1.05)';
            });

            imageWrapper.addEventListener('mouseleave', () => {
                deleteOverlay.style.opacity = '0';
                imageWrapper.style.transform = 'scale(1)';
            });

            deleteOverlay.addEventListener('click', async (e) => {
                e.stopPropagation();
                if (await createModal(['Supprimer d√©finitivement cette image ?'], 'CONFIRM')) {
                    imageWrapper.remove();
                    // Ajouter ici l'appel API pour la suppression r√©elle
                    await createModal(['Image supprim√©e avec succ√®s'], 'INFO');
                }
            });

            // Assemblage des √©l√©ments
            deleteOverlay.appendChild(trashIcon);
            imageWrapper.appendChild(img);
            imageWrapper.appendChild(deleteOverlay);
            imageList.appendChild(imageWrapper);
        });

        // Zone d'upload
        const uploadSection = document.createElement('div');
        uploadSection.style.marginTop = '25px';

        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.multiple = true;
        fileInput.accept = 'image/*';
        fileInput.style.display = 'block';
        fileInput.style.margin = '15px 0';
        fileInput.style.padding = '10px';
        fileInput.style.border = '2px dashed #ccc';
        fileInput.style.borderRadius = '8px';

        const uploadBtn = document.createElement('button');
        uploadBtn.innerHTML = 'üì§ T√©l√©verser les images';
        uploadBtn.style.background = '#4CAF50';
        uploadBtn.style.color = 'white';
        uploadBtn.style.padding = '12px 25px';
        uploadBtn.style.border = 'none';
        uploadBtn.style.borderRadius = '6px';
        uploadBtn.style.cursor = 'pointer';
        uploadBtn.style.transition = 'all 0.3s ease';

        uploadBtn.onmouseenter = () => {
            uploadBtn.style.background = '#45a049';
            uploadBtn.style.transform = 'translateY(-2px)';
        };

        uploadBtn.onmouseleave = () => {
            uploadBtn.style.background = '#4CAF50';
            uploadBtn.style.transform = 'none';
        };

        uploadBtn.onclick = async () => {
            if (!fileInput.files.length) {
                await createModal(['Veuillez s√©lectionner au moins une image'], 'ERROR');
                return;
            }

            uploadBtn.innerHTML = '‚è≥ En cours...';
            uploadBtn.disabled = true;

            // Simulation d'upload
            setTimeout(async () => {
                await createModal(['3 images upload√©es avec succ√®s !'], 'RELOAD');
                uploadBtn.innerHTML = 'üì§ T√©l√©verser les images';
                uploadBtn.disabled = false;
            }, 1500);
        };

        uploadSection.appendChild(fileInput);
        uploadSection.appendChild(uploadBtn);

        await createModal(
            [imageList, uploadSection],
            'INFO',
            'Gestion des m√©dias - Produit #789'
        );
    });
</script>