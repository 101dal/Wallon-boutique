<link rel="stylesheet" href="/css/dashboard/users.css">

<section class="add-user">
    <h2><ion-icon name="person-add-outline"></ion-icon> Ajouter un utilisateur</h2>
    <form id="add-user-form">
        <label for="user-username">Nom d'utilisateur :</label>
        <input type="text" id="user-username" name="user-username" placeholder="Entrez le nom d'utilisateur" required />

        <label for="user-email">Email :</label>
        <input type="email" id="user-email" name="user-email" placeholder="Entrez l'email" required />

        <label for="user-password">Mot de passe :</label>
        <input type="password" id="user-password" name="user-password" placeholder="Entrez le mot de passe" required />

        <label for="user-firstName">Prénom :</label>
        <input type="text" id="user-firstName" name="user-firstName" placeholder="Entrez le prénom" required />

        <label for="user-lastName">Nom :</label>
        <input type="text" id="user-lastName" name="user-lastName" placeholder="Entrez le nom" required />

        <label for="user-role">Rôle :</label>
        <select id="user-role" name="user-role" required>
            <option value="USER">Utilisateur</option>
            <option value="ADMIN">Administrateur</option>
        </select>

        <label for="user-level">Niveau :</label>
        <input type="text" id="user-level" name="user-level" placeholder="Entrez le niveau" />

        <label for="user-classe">Classe :</label>
        <input type="text" id="user-classe" name="user-classe" placeholder="Entrez la classe" />

        <button type="submit">Ajouter l'utilisateur</button>
    </form>
</section>

<section class="user-management">
    <h2>Gestion des utilisateurs</h2>

    <div class="user-filters">
        <label for="filter-username">Nom d'utilisateur :</label>
        <input type="text" id="filter-username" placeholder="Filtrer par nom d'utilisateur" />

        <label for="filter-email">Email :</label>
        <input type="text" id="filter-email" placeholder="Filtrer par email" />

        <label for="filter-firstName">Prénom :</label>
        <input type="text" id="filter-firstName" placeholder="Filtrer par prénom" />

        <label for="filter-lastName">Nom :</label>
        <input type="text" id="filter-lastName" placeholder="Filtrer par nom" />

        <label for="filter-role">Rôle :</label>
        <select id="filter-role">
            <option value="">Tous</option>
            <option value="USER">Utilisateur</option>
            <option value="ADMIN">Administrateur</option>
        </select>

        <button id="apply-filters">Appliquer</button>
    </div>

    <div class="user-list">
        <% if (users.status === 200) { %>
            <% 
                users.content.sort((a, b) => {
                    return a.username.localeCompare(b.username);
                });

                users.content.forEach(user => { 
            %>
                <div class="user-item" data-user-id="<%= user.id %>">
                    <div class="users-info">
                        <label>Nom d'utilisateur :
                            <input type="text" value="<%= user.username %>" class="user-username" />
                        </label>
                        <label>Email :
                            <input type="email" value="<%= user.email %>" class="user-email" />
                        </label>
                        <label>Prénom :
                            <input type="text" value="<%= user.firstName %>" class="user-firstName" />
                        </label>
                        <label>Nom :
                            <input type="text" value="<%= user.lastName %>" class="user-lastName" />
                        </label>
                        <label>Rôle :
                            <select class="user-role">
                                <option value="USER" <%= user.role === 'USER' ? 'selected' : '' %>>Utilisateur</option>
                                <option value="ADMIN" <%= user.role === 'ADMIN' ? 'selected' : '' %>>Administrateur</option>
                            </select>
                        </label>
                        <label>Niveau :
                            <input type="text" value="<%= user.level %>" class="user-level" />
                        </label>
                        <label>Classe :
                            <input type="text" value="<%= user.classe %>" class="user-classe" />
                        </label>
                    </div>
                    <div class="user-actions">
                        <button class="save-user" data-user-id="<%= user.id %>"><ion-icon name="save-outline"></ion-icon></button>
                        <button class="delete-user" data-user-id="<%= user.id %>"><ion-icon name="trash-outline"></ion-icon></button>
                    </div>
                </div>
            <% }); %>
        <% } else { %>
            <p>Aucun utilisateur disponible pour le moment.</p>
        <% } %>
    </div>
</section>

<script src="/scripts/dashboard/users_create.js"></script>
<script src="/scripts/dashboard/users_modify.js"></script>
<script src="/scripts/dashboard/users_search.js"></script>